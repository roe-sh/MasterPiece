<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>Mother Care - Products Management</title>

    <!-- Custom Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Oswald:400,500,700%7CRoboto:400,500&amp;display=swap"
      rel="stylesheet"
    />

    <!-- Perfect Scrollbar -->
    <link
      type="text/css"
      href="assets/vendor/perfect-scrollbar.css"
      rel="stylesheet"
    />

    <!-- Material Design Icons -->
    <link
      type="text/css"
      href="assets/css/material-icons.css"
      rel="stylesheet"
    />

    <!-- Font Awesome Icons -->
    <link type="text/css" href="assets/css/fontawesome.css" rel="stylesheet" />

    <!-- Preloader -->
    <link type="text/css" href="assets/vendor/spinkit.css" rel="stylesheet" />

    <!-- App CSS -->
    <link type="text/css" href="assets/css/app.css" rel="stylesheet" />
  </head>

  <body class="layout-fluid">
    <div class="preloader">
      <div class="sk-chase">
        <div class="sk-chase-dot"></div>
        <div class="sk-chase-dot"></div>
        <div class="sk-chase-dot"></div>
        <div class="sk-chase-dot"></div>
        <div class="sk-chase-dot"></div>
        <div class="sk-chase-dot"></div>
      </div>
    </div>

    <!-- Header Layout -->
    <div class="mdk-header-layout js-mdk-header-layout">
      <!-- Header -->
      <div id="header" data-fixed class="mdk-header js-mdk-header mb-0">
        <div class="mdk-header__content">
          <!-- Navbar -->
          <nav
            id="default-navbar"
            class="navbar navbar-expand navbar-dark bg-primary m-0"
          >
            <div class="container-fluid">
              <!-- Toggle sidebar -->
              <button
                class="navbar-toggler d-block"
                data-toggle="sidebar"
                type="button"
              >
                <span class="material-icons">menu</span>
              </button>

              <!-- Brand -->
              <a href="mothercare-dashboard.html" class="navbar-brand">
                <img
                  src="assets/images/logo.svg"
                  alt="Mother Care"
                  class="mr-2"
                  style="width: 30px"
                />
                <span class="d-none d-xs-md-block">Love Seed</span>
              </a>

              <!-- Search -->
              <form class="search-form d-none d-md-flex">
                <input
                  type="text"
                  class="form-control"
                  placeholder="Search products..."
                />
                <button class="btn" type="button">
                  <i class="material-icons font-size-24pt">search</i>
                </button>
              </form>

              <div class="flex"></div>

              <!-- User dropdown -->
              <ul class="nav navbar-nav flex-nowrap">
                <li class="nav-item dropdown ml-1 ml-md-3">
                  <a
                    class="nav-link dropdown-toggle"
                    data-toggle="dropdown"
                    href="#"
                    role="button"
                    ><img
                      src="assets/images/people/50/user.png"
                      alt="Avatar"
                      class="rounded-circle"
                      width="40"
                    /></a>
                  <div class="dropdown-menu dropdown-menu-right">
                    <a class="dropdown-item" href="mothercare-account-edit.html">
                      <i class="material-icons">edit</i> Edit Account
                    </a>
                    <a class="dropdown-item" href="mothercare-profile.html">
                      <i class="material-icons">person</i> Public Profile
                    </a>
                    <a class="dropdown-item" href="guest-login.html">
                      <i class="material-icons">lock</i> Logout
                    </a>
                  </div>
                </li>
              </ul>
            </div>
          </nav>
          <!-- // END Navbar -->
        </div>
      </div>
      <!-- // END Header -->
      <br>
      <br>
      <br>
      <br>
      <!-- Main container for Products Management -->
      <div class="container mt-4">
        <h1>Products Management</h1>
        <button class="btn btn-primary mb-3" id="addProductBtn">Add Product</button>

        <ul id="products-list" class="list-group">
          <!-- Products will be listed here -->
        </ul>
      </div>


      <!-- Add/Edit Product Modal -->
      <div class="modal" id="productModal">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="productModalTitle">Add Product</h5>
              <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
              <input type="hidden" id="productId" />
              <div class="form-group">
                <label for="productName">Product Name</label>
                <input type="text" id="productName" class="form-control" placeholder="Enter product name" />
              </div>
              <div class="form-group">
                <label for="productPrice">Price</label>
                <input type="number" id="productPrice" class="form-control" placeholder="Enter product price" />
              </div>
              <div class="form-group">
                <label for="productCategory">Category</label>
                <select id="productCategory" class="form-control">
                  <!-- Categories will be populated here -->
                </select>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
              <button type="button" class="btn btn-primary" id="saveProductBtn">Save</button>
            </div>
          </div>
        </div>
      </div>

      <script>
        // Fetch products and display them
        function fetchProducts() {
          fetch('https://api.example.com/products') // Update with your API URL
            .then((response) => response.json())
            .then((data) => {
              const productsList = document.getElementById('products-list');
              productsList.innerHTML = ''; // Clear the list
              data.forEach((product) => {
                const listItem = document.createElement('li');
                listItem.className = 'list-group-item d-flex justify-content-between align-items-center';
                listItem.textContent = `${product.name} - $${product.price}`;

                // Edit Button
                const editBtn = document.createElement('button');
                editBtn.className = 'btn btn-sm btn-warning mr-2';
                editBtn.textContent = 'Edit';
                editBtn.onclick = () => openEditModal(product);

                // Delete Button
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'btn btn-sm btn-danger';
                deleteBtn.textContent = 'Delete';
                deleteBtn.onclick = () => deleteProduct(product.id);

                // Append buttons to list item
                const buttonGroup = document.createElement('div');
                buttonGroup.appendChild(editBtn);
                buttonGroup.appendChild(deleteBtn);

                listItem.appendChild(buttonGroup);
                productsList.appendChild(listItem);
              });
            });
        }

        // Open Modal for Adding or Editing
        function openEditModal(product = null) {
          const productModal = document.getElementById('productModal');
          const productIdInput = document.getElementById('productId');
          const productNameInput = document.getElementById('productName');
          const productPriceInput = document.getElementById('productPrice');
          const productCategoryInput = document.getElementById('productCategory');
          const modalTitle = document.getElementById('productModalTitle');

          if (product) {
            productIdInput.value = product.id;
            productNameInput.value = product.name;
            productPriceInput.value = product.price;
            productCategoryInput.value = product.categoryId;
            modalTitle.textContent = 'Edit Product';
          } else {
            productIdInput.value = '';
            productNameInput.value = '';
            productPriceInput.value = '';
            productCategoryInput.value = '';
            modalTitle.textContent = 'Add Product';
          }

          $('#productModal').modal('show');
        }

        // Save Product (Add or Edit)
        function saveProduct() {
          const productId = document.getElementById('productId').value;
          const productName = document.getElementById('productName').value;
          const productPrice = document.getElementById('productPrice').value;
          const productCategory = document.getElementById('productCategory').value;

          if (productId) {
            // Edit existing product
            fetch(`https://localhost:44303/api/Products/${productId}`, {
              method: 'PUT',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                name: productName,
                price: productPrice,
                categoryId: productCategory,
              }),
            }).then(() => {
              $('#productModal').modal('hide');
              fetchProducts();
            });
          } else {
            // Add new product
            fetch('https://localhost:44303/api/Products', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify({
                name: productName,
                price: productPrice,
                categoryId: productCategory,
              }),
            }).then(() => {
              $('#productModal').modal('hide');
              fetchProducts();
            });
          }
        }

        // Delete Product
        function deleteProduct(productId) {
          if (confirm('Are you sure you want to delete this product?')) {
            fetch(`https://localhost:44303/api/Products/${productId}`, {
              method: 'DELETE',
            }).then(() => {
              fetchProducts();
            });
          }
        }

        // Load Categories into the dropdown
        function loadCategories() {
          fetch('https://localhost:44303/api/Categories/getallcategories') // Update with your API URL
            .then((response) => response.json())
            .then((data) => {
              const productCategoryInput = document.getElementById('productCategory');
              productCategoryInput.innerHTML = '';
              data.forEach((category) => {
                const option = document.createElement('option');
                option.value = category.id;
                option.textContent = category.name;
                productCategoryInput.appendChild(option);
              });
            });
        }

        // Event Listeners
        document.getElementById('addProductBtn').addEventListener('click', () => {
          loadCategories();
          openEditModal();
        });
        document.getElementById('saveProductBtn').addEventListener('click', saveProduct);

        // Load Products on Page Load
        fetchProducts();
      </script>

      <!-- Sidebar -->
      <div class="mdk-drawer js-mdk-drawer" id="default-drawer">
        <div class="mdk-drawer__content">
          <div class="sidebar sidebar-left sidebar-dark bg-dark o-hidden" data-perfect-scrollbar>
            <div class="sidebar-p-y">
              <div class="sidebar-heading">Dashboard</div>
              <ul class="sidebar-menu sm-active-button-bg">
                <li class="sidebar-menu-item">
                  <a class="sidebar-menu-button" href="mothercare-dashboard.html">
                    <i class="sidebar-menu-icon sidebar-menu-icon--left material-icons">account_box</i>
                    General
                  </a>
                </li>
              </ul>

              <div class="sidebar-heading">Resources</div>
              <ul class="sidebar-menu">
                <li class="sidebar-menu-item">
                  <a class="sidebar-menu-button" href="appointments.html">
                    <i class="sidebar-menu-icon sidebar-menu-icon--left material-icons">calendar_today</i>
                    Appointments
                  </a>
                </li>
                <li class="sidebar-menu-item">
                  <a class="sidebar-menu-button" href="mothercare-health-tips.html">
                    <i class="sidebar-menu-icon sidebar-menu-icon--left material-icons">favorite</i>
                    Health Tips
                  </a>
                </li>
                <li class="sidebar-menu-item">
                  <a class="sidebar-menu-button" href="mothercare-doctors-list.html">
                    <i class="sidebar-menu-icon sidebar-menu-icon--left material-icons">group</i>
                    Doctors
                  </a>
                </li>
                <li class="sidebar-menu-item">
                  <a class="sidebar-menu-button" href="categories.html">
                    <i class="sidebar-menu-icon sidebar-menu-icon--left material-icons">category</i>
                    Categories
                  </a>
                </li>
                <li class="sidebar-menu-item active">
                  <a class="sidebar-menu-button" href="Products.html">
                    <i class="sidebar-menu-icon sidebar-menu-icon--left material-icons">shopping_cart</i>
                    Products
                  </a>
                </li>
              </ul>

              <div class="sidebar-heading">Account</div>
              <ul class="sidebar-menu">
                <li class="sidebar-menu-item">
                  <a class="sidebar-menu-button" href="mothercare-account-edit.html">
                    <i class="sidebar-menu-icon sidebar-menu-icon--left material-icons">person_outline</i>
                    Edit Account
                  </a>
                </li>
                <li class="sidebar-menu-item">
                  <a class="sidebar-menu-button" href="guest-login.html">
                    <i class="sidebar-menu-icon sidebar-menu-icon--left material-icons">lock</i>
                    Logout
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- App Settings -->
      <div id="app-settings">
        <app-settings
          layout-active="default"
          :layout-location="{
            'fixed': 'fixed-mothercare-dashboard.html',
            'default': 'mothercare-dashboard.html'
          }"
          sidebar-variant="bg-transparent border-0"
        ></app-settings>
      </div>
    </div>

    <!-- jQuery -->
    <script src="assets/vendor/jquery.min.js"></script>

    <!-- Bootstrap -->
    <script src="assets/vendor/popper.min.js"></script>
    <script src="assets/vendor/bootstrap.min.js"></script>

    <!-- Perfect Scrollbar -->
    <script src="assets/vendor/perfect-scrollbar.min.js"></script>

    <!-- MDK -->
    <script src="assets/vendor/dom-factory.js"></script>
    <script src="assets/vendor/material-design-kit.js"></script>

    <!-- App JS -->
    <script src="assets/js/app.js"></script>

    <!-- Moment.js -->
    <script src="assets/vendor/moment.min.js"></script>
  </body>
</html>
